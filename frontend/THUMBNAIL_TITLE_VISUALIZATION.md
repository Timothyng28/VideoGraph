# Thumbnail and Title Visualization Feature

## Overview
Updated the frontend tree visualization to display section thumbnails and titles generated by the backend.

## Changes Made

### 1. Type Definitions (`src/types/VideoConfig.ts`)

**Updated `VideoSegment` interface:**
```typescript
export interface VideoSegment {
  // ... existing fields ...
  thumbnailUrl?: string; // URL to the thumbnail image (first frame)
  title?: string; // Generated title for this segment
}
```

### 2. Service Layer (`src/services/videoRenderService.ts`)

**Updated `SectionDetail` interface:**
```typescript
export interface SectionDetail {
  section: number;
  video_url: string;
  thumbnail_url?: string;  // NEW: Thumbnail from backend
  title?: string;          // NEW: Generated title from backend
  voiceover_script?: string;
}
```

### 3. Video Controller (`src/controllers/VideoController.tsx`)

**Updated segment mapping to include thumbnails and titles:**
- Maps `thumbnail_url` from backend to `thumbnailUrl` in VideoSegment
- Maps `title` from backend to `title` in VideoSegment
- Uses title as the segment topic if available

```typescript
const segments: VideoSegment[] = result.sections.map((sectionUrl, index) => {
  const detail = detailByUrl.get(sectionUrl);
  return {
    // ... existing fields ...
    videoUrl: sectionUrl,
    thumbnailUrl: detail?.thumbnail_url,
    title: detail?.title,
    topic: detail?.title || topic,
  };
});
```

### 4. Tree Explorer (`src/components/TreeExplorer.tsx`)

**Enhanced Node Component:**
- Displays thumbnail images when available (128x80px)
- Shows node number badge overlay on thumbnails
- Falls back to colored circles if no thumbnail
- Displays title below the node
- Enhanced hover tooltip with:
  - Node number
  - Title
  - Topic (if different from title)
  - Voiceover script preview (first 150 chars)

**Visual Improvements:**
```typescript
// Thumbnail display with badge
<div className="relative w-32 h-20 rounded-lg overflow-hidden shadow-lg border-2">
  <img src={thumbnailUrl} alt={title} className="w-full h-full object-cover" />
  <div className="absolute top-1 left-1 w-6 h-6 rounded-full...">
    {nodeNumber}
  </div>
</div>
```

**Node Data Passed:**
- `nodeNumber`: Section number (e.g., "1.2.3")
- `title`: Generated title for the section
- `thumbnailUrl`: URL to thumbnail image
- `voiceoverScript`: Full narration text
- `nodeColor`: Branch-based color
- `borderColor`: Highlight color for current node

### 5. Tree Visualizer (`src/components/TreeVisualizer.tsx`)

**Mini View Enhancement:**
- Displays tiny thumbnails in circular nodes (10-12px)
- Shows title in hover tooltip
- Graceful fallback if thumbnail fails to load

**Hover Tooltip:**
```typescript
<div className="tooltip">
  <div className="font-semibold">{nodeNumber}</div>
  {title && <div className="text-[10px]">{title}</div>}
</div>
```

## Backend Integration

The frontend expects this data structure from the backend API:

```json
{
  "status": "completed",
  "sections": ["https://.../section_1.mp4", ...],
  "section_details": [
    {
      "section": 1,
      "title": "Understanding Neural Networks",
      "video_url": "https://storage.googleapis.com/vid-gen-static/{job_id}/section_1.mp4",
      "thumbnail_url": "https://storage.googleapis.com/vid-gen-static/{job_id}/section_1_thumbnail.png",
      "voiceover_script": "In this section..."
    }
  ]
}
```

## Visual Design

### Tree Explorer (Full Screen)
- **Node with Thumbnail**: 128x80px rounded rectangle
- **Node without Thumbnail**: 40px circle (original design)
- **Badge**: Node number overlaid on top-left of thumbnail
- **Title**: Displayed below node in rounded label
- **Spacing**: 400px horizontal, 250px vertical

### Tree Visualizer (Mini View)
- **Node Size**: 10-12px circles
- **Thumbnail**: Displayed as circular crop inside node
- **Tooltip**: Shows number and title on hover

## Error Handling

1. **Missing Thumbnails**: Falls back to colored circle display
2. **Failed Image Load**: Catches `onError` and shows fallback UI
3. **Missing Titles**: Falls back to segment topic or section number
4. **Partial Data**: Gracefully handles missing optional fields

## User Experience

### Benefits
1. **Visual Preview**: Users can see thumbnail of each section
2. **Quick Navigation**: Titles help identify content at a glance
3. **Better Context**: Thumbnails provide visual cues about section content
4. **Improved Discoverability**: Easier to find specific sections

### Interactions
1. **Hover over node**: Shows expanded tooltip with title and script preview
2. **Click thumbnail**: Navigates to that section
3. **Current node**: Highlighted with blue glow and border
4. **Image load error**: Seamlessly falls back to circle display

## Testing

To test the feature:

1. **Generate a video** with the updated backend
2. **Open Tree Explorer** (click "Click to expand" on mini tree)
3. **Verify**:
   - Thumbnails display correctly
   - Titles appear below nodes
   - Hover tooltips show full information
   - Current node is highlighted
   - Fallback works for missing thumbnails

## Responsive Design

- **Desktop**: Full thumbnails (128x80px) with titles
- **Mini View**: Circular thumbnails (10-12px) with condensed info
- **Mobile**: Same as desktop but with touch-optimized interactions

## Performance Considerations

1. **Lazy Loading**: Images load on demand via browser
2. **Error Handling**: Failed loads don't block UI
3. **Caching**: Browser caches thumbnails automatically
4. **File Size**: Thumbnails are ~50-200KB (PNG format)

## Future Enhancements

1. **Lazy Loading**: Load thumbnails only when in viewport
2. **Placeholder Images**: Show skeleton while loading
3. **Thumbnail Size Selection**: Different sizes for different zoom levels
4. **Animated Previews**: Short GIF previews instead of static images
5. **Custom Thumbnails**: Allow users to select specific frame

